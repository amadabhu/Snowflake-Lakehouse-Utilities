OPTION 1: Brute force 

insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR2"; insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR3"; insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR4"; insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR5"; insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR6"; insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR7"; insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR8";

 
OPTION 2: Use Union ALL

insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" 
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR2"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR3"
UNION ALL 
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR4"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR5"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR6"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR7"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR8";

 

OPTION 3: Create view and then use view to insert into

CREATE OR REPLACE VIEW OWN_ALL_HOLDINGS_QTR_V 
AS
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR2"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR3"
UNION ALL 
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR4"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR5"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR6"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR7"
UNION ALL
select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR8";

 


insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" SELECT * FROM OWN_ALL_HOLDINGS_QTR_V;

 
OPTION 4: Create a procedure and loop from 2 to 8

 

CREATE OR REPLACE PROCEDURE insert_into_own_all_holdings(START,END)
LANGUAGE JAVASCRIPT
AS
$$
 
  let sql_insert = `
   insert into "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS" 
   select * from "REFINITIV"."STAGING"."OWN_ALL_HOLDINGS_QTR?"
`;

 

  while (START <= END) {
    snowflake.execute({"sqlText" : sql_insert, "binds" : [START]});
    START = START + 1;
  }
   
$$
;
